<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Fire Plan: Operating Information & Access</title>
    <link rel="stylesheet" href="styles-preplan.css">
</head>
<body>
    <div class="page-wrapper">
        <div class="container">
            <header class="report-header">
                <div class="header-top">
                    <img src="images/cfd-logo.png" alt="Centerville Fire Department Logo" class="patch-logo">
                    <div class="header-text">
                        <h1>Centerville Fire Department</h1>
                        <h2>Pre-Fire Plan Data Sheet</h2>
                    </div>
                </div>
            </header>

            <div class="progress-indicator">Page 2 of 12: Operating Information & Access</div>
            
            <div class="progress-bar-container">
                <div class="progress-bar" style="width: 16.66%"></div>
            </div>

            <h3 class="section-title">2. Emergency Contacts & Operating Details</h3>

            <form id="operating-form">
                <!-- Emergency Contacts -->
                <div class="form-row">
                    <div class="form-field">
                        <label for="primary-contact">Primary Emergency Contact:<span class="required">*</span></label>
                        <input type="text" id="primary-contact" name="primary_contact" required placeholder="Name and title">
                    </div>
                    <div class="form-field">
                        <label for="primary-tel">Telephone No.:<span class="required">*</span></label>
                        <input type="tel" id="primary-tel" name="primary_tel" required placeholder="(478) 555-0123">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-field">
                        <label for="secondary-contact">Secondary Emergency Contact:</label>
                        <input type="text" id="secondary-contact" name="secondary_contact" placeholder="Name and title (optional)">
                    </div>
                    <div class="form-field">
                        <label for="secondary-tel">Telephone No.:</label>
                        <input type="tel" id="secondary-tel" name="secondary_tel" placeholder="(478) 555-0987">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-field">
                        <label for="operating-hours">Normal Operating Hours:</label>
                        <input type="text" id="operating-hours" name="operating_hours" placeholder="e.g., Mon–Fri 8AM–5PM, 24/7, Closed weekends">
                    </div>
                    <div class="form-field">
                        <label for="primary-access">Primary Site Access Point:</label>
                        <input type="text" id="primary-access" name="primary_access" placeholder="e.g., Main entrance off Houston Rd">
                    </div>
                </div>

                <h3 class="section-title">Access & Apparatus Concerns</h3>

                <!-- Exterior Access Concerns -->
                <div class="preplan-section">
                    <label class="inline-label">Exterior Access Concerns?</label>
                    <div class="apparatus-buttons" data-group="exterior_access">
                        <label class="apparatus-btn">
                            <input type="radio" name="exterior_access" value="Yes">
                            <span>Yes</span>
                        </label>
                        <label class="apparatus-btn">
                            <input type="radio" name="exterior_access" value="No">
                            <span>No</span>
                        </label>
                    </div>
                    <div class="form-field evaluator-note" style="margin-top: 16px;">
                        <label for="exterior_access_locs">Describe Locations / Concerns:</label>
                        <textarea id="exterior_access_locs" name="exterior_access_locs" rows="3" placeholder="Narrow driveways, low overhead wires, gated entry, etc."></textarea>
                    </div>
                </div>

                <!-- Exterior Door Concerns -->
                <div class="preplan-section">
                    <label class="inline-label">Heavy / Locked Exterior Doors?</label>
                    <div class="apparatus-buttons" data-group="exterior_door">
                        <label class="apparatus-btn">
                            <input type="radio" name="exterior_door" value="Yes">
                            <span>Yes</span>
                        </label>
                        <label class="apparatus-btn">
                            <input type="radio" name="exterior_door" value="No">
                            <span>No</span>
                        </label>
                    </div>
                    <div class="form-field evaluator-note" style="margin-top: 16px;">
                        <label for="exterior_door_locs">Locations / Notes:</label>
                        <textarea id="exterior_door_locs" name="exterior_door_locs" rows="3" placeholder="Security doors, roll-up doors, etc."></textarea>
                    </div>
                </div>

                <!-- Interior Roof Access -->
                <div class="preplan-section">
                    <label class="inline-label">Interior Roof Access Available?</label>
                    <div class="apparatus-buttons" data-group="interior_roof">
                        <label class="apparatus-btn">
                            <input type="radio" name="interior_roof" value="Yes">
                            <span>Yes</span>
                        </label>
                        <label class="apparatus-btn">
                            <input type="radio" name="interior_roof" value="No">
                            <span>No</span>
                        </label>
                    </div>
                    <div class="form-field evaluator-note" style="margin-top: 16px;">
                        <label for="interior_roof_locs">Location of Access (scuttle, ladder, etc.):</label>
                        <textarea id="interior_roof_locs" name="interior_roof_locs" rows="3" placeholder="Describe roof access points"></textarea>
                    </div>
                </div>

                <!-- Obstructions to Aerial Apparatus -->
                <div class="preplan-section">
                    <label class="inline-label">Obstructions to Aerial Apparatus?</label>
                    <div class="apparatus-buttons" data-group="aerial_obstructions">
                        <label class="apparatus-btn">
                            <input type="radio" name="aerial_obstructions" value="Yes">
                            <span>Yes</span>
                        </label>
                        <label class="apparatus-btn">
                            <input type="radio" name="aerial_obstructions" value="No">
                            <span>No</span>
                        </label>
                    </div>
                    <div class="form-field evaluator-note" style="margin-top: 16px;">
                        <label for="aerial_obstructions_locs">Describe (trees, wires, setbacks, etc.):</label>
                        <textarea id="aerial_obstructions_locs" name="aerial_obstructions_locs" rows="3" placeholder="Power lines, trees, building setbacks, etc."></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" id="prev-btn" class="btn-secondary">← Previous</button>
                    <button type="button" id="next-btn" class="btn-primary">Next → Occupancy</button>
                </div>
            </form>
        </div>

        <footer>
            <img src="images/city-logo.png" alt="City of Centerville Logo" class="city-logo">
            <p>© 2026 City of Centerville Fire Department</p>
        </footer>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <script>
        const form = document.getElementById('operating-form');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');

        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<span>${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function getSavedData() {
            return JSON.parse(localStorage.getItem('preFirePlan') || '{}');
        }

        function saveData() {
            const data = { ...getSavedData() };
            const elements = form.querySelectorAll('input, textarea');
            
            elements.forEach(el => {
                if (el.type === 'radio') {
                    if (el.checked) data[el.name] = el.value;
                } else if (el.value) {
                    data[el.name] = el.value;
                }
            });
            
            localStorage.setItem('preFirePlan', JSON.stringify(data));
        }

        // Load saved data
        window.addEventListener('load', () => {
            const saved = getSavedData();
            
            Object.keys(saved).forEach(key => {
                const elements = form.elements[key];
                if (!elements) return;
                
                if (elements.length) {
                    // Radio buttons
                    elements.forEach(el => {
                        if (el.type === 'radio' && saved[key] === el.value) {
                            el.checked = true;
                        }
                    });
                } else {
                    elements.value = saved[key] || '';
                }
            });
        });

        // Auto-save on input
        form.addEventListener('input', () => saveData());
        form.addEventListener('change', () => saveData());

        function navigate(url) {
            saveData();
            window.location.href = url;
        }

        prevBtn.addEventListener('click', () => navigate('page1-location.html'));
        
        nextBtn.addEventListener('click', () => {
            if (form.checkValidity()) {
                saveData();
                showToast('Data saved', 'success');
                setTimeout(() => navigate('page3-occupancy.html'), 500);
            } else {
                form.reportValidity();
            }
        });
    </script>
</body>
</html>
