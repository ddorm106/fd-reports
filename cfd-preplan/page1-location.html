<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Fire Plan: Location</title>
    <link rel="stylesheet" href="styles-preplan.css">
</head>
<body>
    <div class="page-wrapper">
        <div class="container">
            <header class="report-header">
                <div class="header-top">
                    <img src="images/cfd-logo.png" alt="Centerville Fire Department Logo" class="patch-logo">
                    <div class="header-text">
                        <h1>Centerville Fire Department</h1>
                        <h2>Pre-Fire Plan Data Sheet</h2>
                    </div>
                </div>
            </header>

            <div class="progress-indicator">Page 1 of 12: Location</div>
            
            <div class="progress-bar-container">
                <div class="progress-bar" style="width: 8.33%"></div>
            </div>

            <h3 class="section-title">1. Location Information</h3>

            <form id="location-form">
                <div class="form-row">
                    <div class="form-field">
                        <label for="pfp-number">Pre-Plan #:<span class="required">*</span></label>
                        <input type="text" id="pfp-number" name="pfp_number" required placeholder="e.g., PFP-2026-001">
                    </div>
                    <div class="form-field">
                        <label for="business-name">Business Name:<span class="required">*</span></label>
                        <input type="text" id="business-name" name="business_name" required placeholder="Enter business/building name">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-field">
                        <label for="address">Address:<span class="required">*</span></label>
                        <input type="text" id="address" name="address" required placeholder="Street address, City, State ZIP">
                    </div>
                    <div class="form-field">
                        <label for="telephone-no">Telephone No.:</label>
                        <input type="tel" id="telephone-no" name="telephone_no" placeholder="(XXX) XXX-XXXX">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-field">
                        <label for="map-book-page">Map Book Page #:</label>
                        <input type="text" id="map-book-page" name="map_book_page" placeholder="Reference page number">
                    </div>
                    <div class="form-field">
                        <label for="fire-district">Fire District:</label>
                        <input type="text" id="fire-district" name="fire_district" placeholder="District name or number">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-field">
                        <label for="latitude">Latitude:</label>
                        <input type="text" id="latitude" name="latitude" placeholder="e.g., 32.8407">
                    </div>
                    <div class="form-field">
                        <label for="longitude">Longitude:</label>
                        <input type="text" id="longitude" name="longitude" placeholder="e.g., -83.6499">
                    </div>
                </div>

                <div class="form-field">
                    <label for="general-directions">General Directions to Site:</label>
                    <textarea id="general-directions" name="general_directions" rows="4" placeholder="Describe access routes, landmarks, alternate approaches, etc."></textarea>
                </div>

                <div class="form-actions">
                    <a href="index.html" class="btn-secondary">← Back to Overview</a>
                    <button type="button" id="next-btn" class="btn-primary">Next → Operating Information</button>
                </div>
            </form>
        </div>

        <footer>
            <img src="images/city-logo.png" alt="City of Centerville Logo" class="city-logo">
            <p>© 2026 City of Centerville Fire Department</p>
        </footer>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <script>
        const form = document.getElementById('location-form');
        const nextBtn = document.getElementById('next-btn');

        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<span>${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function getSavedData() {
            return JSON.parse(localStorage.getItem('preFirePlan') || '{}');
        }

        function saveData() {
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            const existing = getSavedData();
            localStorage.setItem('preFirePlan', JSON.stringify({ ...existing, ...data }));
        }

        // Load saved data
        window.addEventListener('load', () => {
            const savedData = getSavedData();
            Object.keys(savedData).forEach(key => {
                const element = form.elements[key];
                if (element) {
                    element.value = savedData[key];
                }
            });
        });

        // Auto-save on input
        form.addEventListener('input', () => {
            saveData();
        });

        // Navigate to next page
        nextBtn.addEventListener('click', () => {
            if (form.checkValidity()) {
                saveData();
                showToast('Data saved', 'success');
                setTimeout(() => {
                    window.location.href = 'page2-operating.html';
                }, 500);
            } else {
                form.reportValidity();
            }
        });

        // Allow Enter key to proceed
        form.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
                nextBtn.click();
            }
        });
    </script>
</body>
</html>
