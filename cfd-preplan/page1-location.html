<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Pre-Fire Plan: Location</title>
<link rel="stylesheet" href="styles-preplan.css">

</head>
<body>
<div class="page-wrapper">
    <div class="container">
        <header class="report-header">
            <div class="header-top">
                <img src="images/cfd-logo.png" alt="Centerville Fire Department" class="patch-logo">
                <div class="header-text">
                    <h1>Centerville Fire Department</h1>
                    <h2>Pre-Fire Plan Data Sheet</h2>
                </div>
            </div>
        </header>

        <div class="progress-indicator">Page 1 of 12: Location</div>
        <div class="progress-bar-container">
            <div class="progress-bar" style="width: 8.33%"></div>
        </div>


        <h3 class="section-title">1. Location Information</h3>
        <form id="theForm">
            <div class="form-row">
                        <div class="form-field"><label for="pfp_number">Pre-Plan #:<span class="required">*</span></label><input type="text" id="pfp_number" name="pfp_number" required placeholder="PFP-2026-001"></div>
                        <div class="form-field"><label for="business_name">Business / Building Name:<span class="required">*</span></label><input type="text" id="business_name" name="business_name" required placeholder="Walmart Supercenter"></div>
            </div>
            <div class="form-row">
                        <div class="form-field"><label for="address">Address:<span class="required">*</span></label><input type="text" id="address" name="address" required placeholder="123 Main St, Centerville, GA 31028"></div>
                        <div class="form-field"><label for="telephone_no">Telephone:</label><input type="tel" id="telephone_no" name="telephone_no" placeholder="(478) 555-1234"></div>
            </div>
            <div class="form-row">
                        <div class="form-field"><label for="tax_id">Tax ID:</label><input type="text" id="tax_id" name="tax_id" placeholder="T001-234-567"></div>
                        <div class="form-field"><label for="fire_district">Fire District:</label><input type="text" id="fire_district" name="fire_district" placeholder="District 1"></div>
            </div>
            <div class="form-row">
                        <div class="form-field"><label for="latitude">Latitude:</label><input type="text" id="latitude" name="latitude" placeholder="32.8407"></div>
                        <div class="form-field"><label for="longitude">Longitude:</label><input type="text" id="longitude" name="longitude" placeholder="-83.6499"></div>
                        <div class="form-field" style="flex:0 0 auto;align-self:flex-end;">
                            <button type="button" id="gpsBtn" class="btn-secondary" onclick="getGPS()" style="white-space:nowrap;display:flex;align-items:center;gap:6px;padding:8px 14px;">
                                <span id="gpsIcon">üìç</span> <span id="gpsText">Get GPS</span>
                            </button>
                        </div>
            </div>
                    <div class="form-field"><label for="general_directions">General Directions to Site:</label><textarea id="general_directions" name="general_directions" rows="3" placeholder="Main entrance off Houston Rd, 2nd driveway past the light..."></textarea></div>
        </form>


        <div class="nav-buttons">
            <a href="preplan-index.html" class="btn-secondary">‚Üê Overview</a>
            <button type="button" class="btn-primary" onclick="navigate('page2-operating.html',document.getElementById('theForm'))">Next ‚Üí</button>
        </div>
    </div>
</div>
<footer>
    <img src="images/city-logo.png" alt="City of Centerville" class="city-logo">
    <p>¬© 2026 City of Centerville Fire Department</p>
</footer>
<div class="toast-container" id="toast-container"></div>
<script src="preplan-common.js"></script>
<script>
var form=document.getElementById('theForm');
if(form){loadFormData(form);autoSave(form);}

function getGPS(){
    var btn=document.getElementById('gpsBtn');
    var icon=document.getElementById('gpsIcon');
    var txt=document.getElementById('gpsText');
    if(!navigator.geolocation){
        showToast('GPS not available on this device','error');
        return;
    }
    btn.disabled=true;
    icon.textContent='‚è≥';
    txt.textContent='Locating...';
    navigator.geolocation.getCurrentPosition(
        function(pos){
            document.getElementById('latitude').value=pos.coords.latitude.toFixed(6);
            document.getElementById('longitude').value=pos.coords.longitude.toFixed(6);
            // Trigger change events so autoSave picks them up
            document.getElementById('latitude').dispatchEvent(new Event('input',{bubbles:true}));
            document.getElementById('longitude').dispatchEvent(new Event('input',{bubbles:true}));
            icon.textContent='‚úÖ';
            txt.textContent='Got it!';
            showToast('GPS coordinates captured','success');
            setTimeout(function(){icon.textContent='üìç';txt.textContent='Get GPS';btn.disabled=false;},2000);
        },
        function(err){
            var msg='GPS failed';
            if(err.code===1) msg='Location access denied ‚Äî check browser permissions';
            else if(err.code===2) msg='Position unavailable';
            else if(err.code===3) msg='GPS timed out ‚Äî try again';
            icon.textContent='‚ùå';
            txt.textContent='Failed';
            showToast(msg,'error');
            setTimeout(function(){icon.textContent='üìç';txt.textContent='Get GPS';btn.disabled=false;},2500);
        },
        {enableHighAccuracy:true, timeout:15000, maximumAge:0}
    );
}
</script>
</body>
</html>
