<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Fire Plan: Special Rescue Considerations</title>
    <link rel="stylesheet" href="styles-preplan.css">
    <style>
        .nfpa-diamond {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        .nfpa-diamond svg {
            width: 150px;
            height: 150px;
        }
        .diamond-inputs {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            max-width: 500px;
            margin: 20px auto;
        }
        .diamond-input {
            text-align: center;
        }
        .diamond-input label {
            display: block;
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 0.85rem;
        }
        .diamond-input input {
            width: 60px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
        }
        .diamond-input.health label { color: #2563EB; }
        .diamond-input.fire label { color: #DC2626; }
        .diamond-input.reactivity label { color: #FBBF24; }
        .diamond-input.special label { color: #fff; background: #000; padding: 2px 6px; border-radius: 4px; display: inline-block; }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <div class="container">
            <header class="report-header">
                <div class="header-top">
                    <img src="images/cfd-logo.png" alt="Centerville Fire Department Logo" class="patch-logo">
                    <div class="header-text">
                        <h1>Centerville Fire Department</h1>
                        <h2>Pre-Fire Plan Data Sheet</h2>
                    </div>
                </div>
            </header>

            <div class="progress-indicator">Page 7 of 12: Special Rescue Considerations</div>
            <div class="progress-bar-container">
                <div class="progress-bar" style="width: 58.33%"></div>
            </div>

            <h3 class="section-title">7. Special Rescue Considerations</h3>

            <form id="special-rescue-form">
                <!-- NFPA 704 Diamond -->
                <div class="preplan-section">
                    <label class="inline-label">NFPA 704 Hazard Diamond (if posted):</label>
                    <div class="nfpa-diamond">
                        <svg viewBox="0 0 100 100">
                            <polygon points="50,5 95,50 50,95 5,50" fill="none" stroke="#333" stroke-width="2"/>
                            <polygon points="50,5 72.5,27.5 50,50 27.5,27.5" fill="#DC2626"/>
                            <polygon points="72.5,27.5 95,50 72.5,72.5 50,50" fill="#FBBF24"/>
                            <polygon points="50,50 72.5,72.5 50,95 27.5,72.5" fill="#fff" stroke="#333"/>
                            <polygon points="5,50 27.5,27.5 50,50 27.5,72.5" fill="#2563EB"/>
                            <text x="50" y="32" text-anchor="middle" fill="white" font-weight="bold" font-size="14" id="fire-text">0</text>
                            <text x="73" y="55" text-anchor="middle" fill="black" font-weight="bold" font-size="14" id="reactivity-text">0</text>
                            <text x="50" y="78" text-anchor="middle" fill="black" font-weight="bold" font-size="14" id="special-text">-</text>
                            <text x="27" y="55" text-anchor="middle" fill="white" font-weight="bold" font-size="14" id="health-text">0</text>
                        </svg>
                    </div>
                    <div class="diamond-inputs">
                        <div class="diamond-input health">
                            <label>Health (Blue)</label>
                            <input type="number" name="nfpa_health" min="0" max="4" value="0">
                        </div>
                        <div class="diamond-input fire">
                            <label>Fire (Red)</label>
                            <input type="number" name="nfpa_fire" min="0" max="4" value="0">
                        </div>
                        <div class="diamond-input reactivity">
                            <label>Reactivity (Yellow)</label>
                            <input type="number" name="nfpa_reactivity" min="0" max="4" value="0">
                        </div>
                        <div class="diamond-input special">
                            <label>Special</label>
                            <input type="text" name="nfpa_special" maxlength="3" placeholder="OX, W">
                        </div>
                    </div>
                </div>

                <!-- Confined Space -->
                <div class="preplan-section">
                    <label class="inline-label">Confined Space Rescue Potential:</label>
                    <div class="apparatus-buttons">
                        <label class="apparatus-btn"><input type="radio" name="confined_space" value="Yes"><span>Yes</span></label>
                        <label class="apparatus-btn"><input type="radio" name="confined_space" value="No"><span>No</span></label>
                    </div>
                    <div class="form-field" style="margin-top: 16px;">
                        <label for="confined_locs">Locations:</label>
                        <input type="text" id="confined_locs" name="confined_locs" placeholder="e.g., Storage tanks, manholes, vaults">
                    </div>
                </div>

                <!-- High Angle -->
                <div class="preplan-section">
                    <label class="inline-label">High Angle Rescue Potential:</label>
                    <div class="apparatus-buttons">
                        <label class="apparatus-btn"><input type="radio" name="high_angle" value="Yes"><span>Yes</span></label>
                        <label class="apparatus-btn"><input type="radio" name="high_angle" value="No"><span>No</span></label>
                    </div>
                    <div class="form-field" style="margin-top: 16px;">
                        <label for="high_angle_locs">Locations:</label>
                        <input type="text" id="high_angle_locs" name="high_angle_locs" placeholder="e.g., Rooftop, catwalks, silos">
                    </div>
                </div>

                <!-- Trench/Collapse -->
                <div class="preplan-section">
                    <label class="inline-label">Trench/Collapse Rescue Potential:</label>
                    <div class="apparatus-buttons">
                        <label class="apparatus-btn"><input type="radio" name="trench_collapse" value="Yes"><span>Yes</span></label>
                        <label class="apparatus-btn"><input type="radio" name="trench_collapse" value="No"><span>No</span></label>
                    </div>
                    <div class="form-field" style="margin-top: 16px;">
                        <label for="trench_locs">Locations/Details:</label>
                        <input type="text" id="trench_locs" name="trench_locs" placeholder="e.g., Construction areas, excavation sites">
                    </div>
                </div>

                <!-- Water Rescue -->
                <div class="preplan-section">
                    <label class="inline-label">Water Rescue Potential:</label>
                    <div class="apparatus-buttons">
                        <label class="apparatus-btn"><input type="radio" name="water_rescue" value="Yes"><span>Yes</span></label>
                        <label class="apparatus-btn"><input type="radio" name="water_rescue" value="No"><span>No</span></label>
                    </div>
                    <div class="form-field" style="margin-top: 16px;">
                        <label for="water_rescue_locs">Locations:</label>
                        <input type="text" id="water_rescue_locs" name="water_rescue_locs" placeholder="e.g., Retention ponds, pools, tanks">
                    </div>
                </div>

                <!-- Other Special Rescues -->
                <div class="preplan-section">
                    <label class="inline-label">Other Special Rescue Considerations:</label>
                    <div class="apparatus-buttons">
                        <label class="apparatus-btn"><input type="radio" name="other_rescues" value="Yes"><span>Yes</span></label>
                        <label class="apparatus-btn"><input type="radio" name="other_rescues" value="No"><span>No</span></label>
                    </div>
                    <div class="form-field" style="margin-top: 16px;">
                        <label for="other_rescues_explain">Explain:</label>
                        <textarea id="other_rescues_explain" name="other_rescues_explain" rows="3" placeholder="Machinery entrapment, elevator rescue, etc."></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" id="prev-btn" class="btn-secondary">← Previous</button>
                    <button type="button" id="next-btn" class="btn-primary">Next → Fire Flow Data</button>
                </div>
            </form>
        </div>

        <footer>
            <img src="images/city-logo.png" alt="City of Centerville Logo" class="city-logo">
            <p>© 2026 City of Centerville Fire Department</p>
        </footer>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <script>
        const form = document.getElementById('special-rescue-form');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');

        // Update NFPA diamond display
        function updateDiamond() {
            document.getElementById('health-text').textContent = form.elements['nfpa_health'].value || '0';
            document.getElementById('fire-text').textContent = form.elements['nfpa_fire'].value || '0';
            document.getElementById('reactivity-text').textContent = form.elements['nfpa_reactivity'].value || '0';
            document.getElementById('special-text').textContent = form.elements['nfpa_special'].value || '-';
        }

        document.querySelectorAll('.diamond-input input').forEach(input => {
            input.addEventListener('input', updateDiamond);
        });

        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<span>${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => { toast.style.opacity = '0'; setTimeout(() => toast.remove(), 300); }, 3000);
        }

        function getSavedData() {
            return JSON.parse(localStorage.getItem('preFirePlan') || '{}');
        }

        function saveData() {
            const data = { ...getSavedData() };
            form.querySelectorAll('input, textarea').forEach(el => {
                if (el.type === 'radio') {
                    if (el.checked) data[el.name] = el.value;
                } else if (el.value) {
                    data[el.name] = el.value;
                }
            });
            localStorage.setItem('preFirePlan', JSON.stringify(data));
        }

        window.addEventListener('load', () => {
            const saved = getSavedData();
            Object.keys(saved).forEach(key => {
                const el = form.elements[key];
                if (!el) return;
                if (el.length) {
                    el.forEach(e => {
                        if (e.type === 'radio' && saved[key] === e.value) e.checked = true;
                    });
                } else {
                    el.value = saved[key] || '';
                }
            });
            updateDiamond();
        });

        form.addEventListener('input', () => saveData());
        form.addEventListener('change', () => saveData());

        function navigate(url) { saveData(); window.location.href = url; }

        prevBtn.addEventListener('click', () => navigate('page6-utilities.html'));
        nextBtn.addEventListener('click', () => {
            if (form.checkValidity()) {
                saveData();
                showToast('Data saved', 'success');
                setTimeout(() => navigate('page8-fire-flow.html'), 500);
            } else { form.reportValidity(); }
        });
    </script>
</body>
</html>
